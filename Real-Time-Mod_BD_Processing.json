{"paragraphs":[{"text":"\n\nimport org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType};\nimport spark.implicits._\n\nval socketDF = spark\n  .readStream\n  .format(\"socket\")\n  .option(\"host\", \"localhost\")\n  .option(\"port\", 7777)\n  .load()//conexiòn al socket en el puerto 7777\n\nsocketDF.isStreaming   \n\nsocketDF.printSchema\n\n\nval userSchema = new StructType().add(\"MLS\", \"string\").add(\"Location\", \"string\").add(\"Bedrooms\", \"integer\").add(\"Bathrooms\", \"integer\").add(\"Size\", \"integer\").add(\"PriceSqFt\", \"float\")\n.add(\"Status\", \"string\")//Schema con el que se formarà el DF\nval csvDF = spark\n  .readStream\n  .option(\"sep\",\",\")\n  .schema(userSchema)      \n  .csv(\"/home/kc/mod-bd-processing/practica/datasets/real-estate\")//lectura streaming del directorio real-estate   \n \ncase class RealEstate(MLS: String, location: String, bedrooms: Int , bathrooms: Int, size: Int, pricesqft: Float, status: String)//case class RealEstate para poder generar un DataSet\n\n//val dfRealEstate = csvDF.toDF()\nval dsRealEstate = df.as[RealEstate]\n\nvar limite:Float = 400\n\nval prices = dsRealEstate.filter(_.pricesqft > limite*0.88).map(_.location)//selecciona las locaciones con los precios que superaron el lìmite\n\n//Imprime las locaciones cuyo precio superò al limite\nval query = prices.writeStream\n  .outputMode(\"update\")\n  .format(\"console\")\n  .start()\n\nquery.awaitTermination()\n","user":"anonymous","dateUpdated":"2019-03-12T17:34:30+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552345176297_-1770278653","id":"20190311-235936_613769595","dateCreated":"2019-03-11T23:59:36+0100","dateStarted":"2019-03-12T17:34:30+0100","dateFinished":"2019-03-12T17:33:38+0100","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1614"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552346082094_442289624","id":"20190312-001442_2073538023","dateCreated":"2019-03-12T00:14:42+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1615"}],"name":"Real-Time-Mod_BD_Processing","id":"2E6BE3CGS","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}